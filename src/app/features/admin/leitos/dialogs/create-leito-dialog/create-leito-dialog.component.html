<app-dialog-layout
  dialogTitle="Criar Leito"
  confirmLabel="Confirmar"
  [onConfirm]="createLeito"
  [confirmDisabled]="form.invalid"
>
  <form [formGroup]="form" class="flex flex-col gap-4">
    <app-custom-label label="CÃ³digo" for="codigo">
      <mat-form-field>
        <input id="codigo" matInput formControlName="codigoSala" />
        <mat-error>
          {{ errorMessage(form.get("codigoSala")) }}
        </mat-error>
      </mat-form-field>
    </app-custom-label>

    <app-custom-label label="Status" for="status">
      <div>
        <mat-button-toggle-group
          id="status"
          formControlName="livre"
          aria-label="Status do Leito"
        >
          <mat-button-toggle [value]="true">Livre</mat-button-toggle>
          <mat-button-toggle [value]="false">Ocupado</mat-button-toggle>
        </mat-button-toggle-group>
      </div>
    </app-custom-label>

    @if (form.get("livre")?.value === false) {
      <mat-form-field>
        <input
          matInput
          id="paciente"
          formControlName="paciente"
          placeholder="Selecione o paciente"
          [matAutocomplete]="autoPaciente"
        />
        <mat-autocomplete
          #autoPaciente="matAutocomplete"
          [displayWith]="displayOption"
        >
          @for (option of filteredPacientes$ | async; track option) {
            <mat-option [value]="option">{{ option.nome }}</mat-option>
          }
        </mat-autocomplete>

        <mat-error>
          {{ errorMessage(form.get("paciente")) }}
        </mat-error>
      </mat-form-field>
    }
  </form>
</app-dialog-layout>
